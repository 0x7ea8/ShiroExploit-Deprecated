package com.shiroexploit.util;

import java.util.*;

public class Config {
    private static Config config;
    private List<String> keys;
    // 0 for Shiro550, 1 for Shiro721
    private int vulType = 0;
    // 0 for ceye, 1 for self-implemented oob service
    private int oobType = 0;
    private boolean useJRMP = true;
    private boolean skipIfFound = true;
    private String ceyeDomain;
    private String ceyeToken;
    private String OOBServerAddress;
    private int HTTPServicePort;
    private int JRMPServicePort;
    private int delay;
    private HttpRequestInfo requestInfo;
    private String rememberMeCookieName;

    public static Config getInstance(){
        //懒汉式
        if(config == null){
            config = new Config();

            //初始化key
            List<String> list = ConfigReader.loadKeys();

            if(list.size() == 0){
                list.add("kPH+bIxk5D2deZiIxcaaaA==");
            }

            config.setKeys(list);

            String value = ConfigReader.getConfig("rememberMeCookieName");
            value = value == null ? "rememberMe" : value.trim();
            config.setRememberMeCookieName(value);

            String ceyeDomain = ConfigReader.getConfig("ceyeDomain");
            ceyeDomain = ceyeDomain == null ? "7wtusr.ceye.io" : ceyeDomain.trim();
            config.setCeyeDomain(ceyeDomain);

            String ceyeToken = ConfigReader.getConfig("ceyeToken");
            ceyeToken = ceyeToken == null ? "a78a1cb49d91fe09e01876078d1868b2" : ceyeToken.trim();
            config.setCeyeToken(ceyeToken);

            String delay = ConfigReader.getConfig("delay");
            int time = delay == null ? 5 : Integer.parseInt(delay.trim());
            config.setDelay(time);

        }

        return config;
    }

    public String getRememberMeCookieName() {
        return rememberMeCookieName;
    }

    public void setRememberMeCookieName(String rememberMeCookieName) {
        this.rememberMeCookieName = rememberMeCookieName;
    }

    public HttpRequestInfo getRequestInfo() {
        return requestInfo;
    }

    public void setRequestInfo(HttpRequestInfo requestInfo) {
        this.requestInfo = requestInfo;
    }

    public int getOobType() {
        return oobType;
    }

    public void setOobType(int oobType) {
        this.oobType = oobType;
    }

    public List<String> getKeys() {
        return keys;
    }

    public void setKeys(List<String> keys) {
        this.keys = keys;
    }

    public int getVulType() {
        return vulType;
    }

    public void setVulType(int vulType) {
        this.vulType = vulType;
    }

    public boolean isUseJRMP() {
        return useJRMP;
    }

    public void setUseJRMP(boolean useJRMP) {
        this.useJRMP = useJRMP;
    }

    public boolean isSkipIfFound() {
        return skipIfFound;
    }

    public void setSkipIfFound(boolean skipIfFound) {
        this.skipIfFound = skipIfFound;
    }

    public String getCeyeDomain() {
        return ceyeDomain;
    }

    public String getCeyeToken() {
        return ceyeToken;
    }

    public void setCeyeDomain(String ceyeDomain) {
        this.ceyeDomain = ceyeDomain;
    }

    public void setCeyeToken(String ceyeToken) {
        this.ceyeToken = ceyeToken;
    }

    public void setDelay(int delay) {
        this.delay = delay;
    }

    public String getOOBServerAddress() {
        return OOBServerAddress;
    }

    public void setOOBServerAddress(String OOBServerAddress) {
        this.OOBServerAddress = OOBServerAddress;
    }

    public int getHTTPServicePort() {
        return HTTPServicePort;
    }

    public void setHTTPServicePort(int HTTPServicePort) {
        this.HTTPServicePort = HTTPServicePort;
    }

    public int getJRMPServicePort() {
        return JRMPServicePort;
    }

    public void setJRMPServicePort(int JRMPServicePort) {
        this.JRMPServicePort = JRMPServicePort;
    }

    public int getDelay() {
        return delay;
    }
}
